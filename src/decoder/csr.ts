import { DecodeFieldType } from './types'
import type { DecodeMode } from './types'

export const csrDecoders: DecodeMode[] = [
  // 0x300 - mstatus
  {
    name: 'mstatus',
    fields: [
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'SIE' },
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'MIE' },
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'SPIE' },
      { width: 1, name: 'UBE' },
      { width: 1, name: 'MPIE' },
      { width: 1, name: 'SPP', value: ['U', 'VS'] },
      { width: 2, name: 'VS', value: ['Off', 'Initial', 'Clean', 'Dirty'] },
      { width: 2, name: 'MPP', value: ['U', 'VS', 'HS', 'M'] },
      { width: 2, name: 'FS', value: ['Off', 'Initial', 'Clean', 'Dirty'] },
      { width: 2, name: 'XS', value: ['Off', 'Initial', 'Clean', 'Dirty'] },
      { width: 1, name: 'MPRV' },
      { width: 1, name: 'SUM' },
      { width: 1, name: 'MXR' },
      { width: 1, name: 'TVM' },
      { width: 1, name: 'TW' },
      { width: 1, name: 'TSR' },
      { width: 1, name: 'SPELP' },
      { width: 1, name: 'SDT' },
      { width: 7, type: DecodeFieldType.CSR_WPRI },
      { width: 2, name: 'UXL', value: ['Not supported', '32', '64', 'Reserved'] },
      { width: 2, name: 'SXL', value: ['Not supported', '32', '64', 'Reserved'] },
      { width: 1, name: 'SBE', value: ['Little endian', 'Big endian'] },
      { width: 1, name: 'MBE', value: ['Little endian', 'Big endian'] },
      { width: 1, name: 'GVA' },
      { width: 1, name: 'MPV' },
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'MPELP' },
      { width: 1, name: 'MDT' },
      { width: 20, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'SD' },
    ],
  },
  // 0x301 - misa
  {
    name: 'misa',
    fields: [
      { width: 1, name: 'A' },
      { width: 1, name: 'B' },
      { width: 1, name: 'C' },
      { width: 1, name: 'D' },
      { width: 1, name: 'E' },
      { width: 1, name: 'F' },
      { width: 1, name: 'G' },
      { width: 1, name: 'H' },
      { width: 1, name: 'I' },
      { width: 1, name: 'J' },
      { width: 1, name: 'K' },
      { width: 1, name: 'L' },
      { width: 1, name: 'M' },
      { width: 1, name: 'N' },
      { width: 1, name: 'O' },
      { width: 1, name: 'P' },
      { width: 1, name: 'Q' },
      { width: 1, name: 'R' },
      { width: 1, name: 'S' },
      { width: 1, name: 'T' },
      { width: 1, name: 'U' },
      { width: 1, name: 'V' },
      { width: 1, name: 'W' },
      { width: 1, name: 'X' },
      { width: 1, name: 'Y' },
      { width: 1, name: 'Z' },
      { width: 36, type: DecodeFieldType.CSR_RO0 },
      { width: 2, name: 'MXL', value: ['Not supported', '32', '64', 'Reserved'] },
    ],
  },
  // 0x302 - medeleg
  {
    name: 'medeleg',
    fields: [
      { width: 1, name: 'IAM' },
      { width: 1, name: 'IAF' },
      { width: 1, name: 'II' },
      { width: 1, name: 'B' },
      { width: 1, name: 'LAM' },
      { width: 1, name: 'LAF' },
      { width: 1, name: 'SAM' },
      { width: 1, name: 'SAF' },
      { width: 1, name: 'EU' },
      { width: 1, name: 'EVS' },
      { width: 1, name: 'EM', type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'IPF' },
      { width: 1, name: 'LPF' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SPF' },
      { width: 1, name: 'DT' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SC' },
      { width: 1, name: 'HE' },
      { width: 1, name: 'IGPF' },
      { width: 1, name: 'LGPF' },
      { width: 1, name: 'VI' },
      { width: 1, name: 'SGPF' },
      { width: 40, type: DecodeFieldType.CSR_RO0 },
    ],
  },
  // 0x303 - mideleg
  {
    name: 'mideleg',
    fields: [
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SSIP' },
      { width: 1, name: 'VSSIP' },
      { width: 1, name: 'MSIP' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'STIP' },
      { width: 1, name: 'VSTIP' },
      { width: 1, name: 'MTIP' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SEIP' },
      { width: 1, name: 'VSEIP' },
      { width: 1, name: 'MEIP' },
      { width: 1, name: 'SGEIP' },
      { width: 1, name: 'LCOFIP' },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 48, type: DecodeFieldType.CSR_WPRI },
    ],
  },
  // 0x304 - mie
  {
    name: 'mie',
    fields: [
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SSIE' },
      { width: 1, name: 'VSSIE' },
      { width: 1, name: 'MSIE' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'STIE' },
      { width: 1, name: 'VSTIE' },
      { width: 1, name: 'MTIE' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SEIE' },
      { width: 1, name: 'VSEIE' },
      { width: 1, name: 'MEIE' },
      { width: 1, name: 'SGEIE' },
      { width: 1, name: 'LCOFIE' },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 48, type: DecodeFieldType.CSR_WPRI },
    ],
  },
  // 0x305 - mtvec
  {
    name: 'mtvec',
    fields: [
      { width: 2, name: 'MODE', value: ['Direct', 'Vectored', 'Reserved', 'Reserved'] },
      { width: 62, name: 'BASE' },
    ],
  },
  // 0x306 - mcounteren
  {
    name: 'mcounteren',
    fields: [
      { width: 1, name: 'CY' },
      { width: 1, name: 'TM' },
      { width: 1, name: 'IR' },
      { width: 29, name: 'HPM[31:3]' },
      { width: 32, type: DecodeFieldType.CSR_RO0 },
    ],
  },
  // 0x30A - menvcfg
  {
    name: 'menvcfg',
    fields: [
      { width: 1, name: 'FIOM' },
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'LPE' },
      { width: 1, name: 'SSE' },
      { width: 2, name: 'CBIE', value: ['Invalid', 'Flush', 'Invalidate', 'Reserved'] },
      { width: 1, name: 'CBCFE' },
      { width: 1, name: 'CBZE' },
      { width: 24, type: DecodeFieldType.CSR_WPRI },
      { width: 2, name: 'PMM' },
      { width: 25, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'DTE' },
      { width: 1, name: 'CDE' },
      { width: 1, name: 'ADUE' },
      { width: 1, name: 'PBMTE' },
      { width: 1, name: 'STCE' },
    ],
  },
  // 0x30C - mstateen0
  {
    name: 'mstateen0',
    fields: [
      { width: 1, name: 'C' },
      { width: 1, name: 'FCSR' },
      { width: 1, name: 'JVT' },
      { width: 51, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'CTR' },
      { width: 1, name: 'SRMCFG' },
      { width: 1, name: 'P1P13' },
      { width: 1, name: 'CONTEXT' },
      { width: 1, name: 'IMISC' },
      { width: 1, name: 'AIA' },
      { width: 1, name: 'CSRIND' },
      { width: 1, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'ENVCFG' },
      { width: 1, name: 'SE0' },
    ],
  },
  // 0x320 - mcountinhibit
  {
    name: 'mcountinhibit',
    fields: [
      { width: 1, name: 'CY' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'IR' },
      { width: 29, name: 'HPM[31:3]' },
      { width: 32, type: DecodeFieldType.CSR_RO0 },
    ],
  },
  // 0x321 - mcyclecfg
  {
    name: 'mcyclecfg',
    fields: [
      { width: 58, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'VUINH' },
      { width: 1, name: 'VSINH' },
      { width: 1, name: 'UINH' },
      { width: 1, name: 'SINH' },
      { width: 1, name: 'MINH' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
    ],
  },
  // 0x340 - mscratch
  {
    name: 'mscratch',
    fields: [
      { width: 64, name: 'VALUE' },
    ],
  },
  // 0x341 - mepc
  {
    name: 'mepc',
    fields: [
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'PC[1]' },
      { width: 62, name: 'PC[63:2]' },
    ],
  },
  // 0x342 - mcause
  {
    name: 'mcause',
    fields: [
      {
        width: 64,
        name: 'Exception Code',
        value: new Map<BigInt, string>([
          [BigInt(0x0), 'Instruction address misaligned'],
          [BigInt(0x1), 'Instruction access fault'],
          [BigInt(0x2), 'Illegal instruction'],
          [BigInt(0x3), 'Breakpoint'],
          [BigInt(0x4), 'Load address misaligned'],
          [BigInt(0x5), 'Load access fault'],
          [BigInt(0x6), 'Store/AMO address misaligned'],
          [BigInt(0x7), 'Store/AMO access fault'],
          [BigInt(0x8), 'Environment call from U-mode or VU-mode'],
          [BigInt(0x9), 'Environment call from HS-mode'],
          [BigInt(0xA), 'Environment call from VS-mode'],
          [BigInt(0xB), 'Environment call from M-mode'],
          [BigInt(0xC), 'Instruction page fault'],
          [BigInt(0xD), 'Load page fault'],
          [BigInt(0xF), 'Store/AMO page fault'],
          [BigInt(0x10), 'Double trap'],
          [BigInt(0x12), 'Software check'],
          [BigInt(0x13), 'Hardware error'],
          [BigInt(0x14), 'Instruction guest-page fault'],
          [BigInt(0x15), 'Load guest-page fault'],
          [BigInt(0x16), 'Virtual instruction'],
          [BigInt(0x17), 'Store/AMO guest-page fault'],
          [BigInt(0x18), 'Custom exception'],
          [BigInt(0x19), 'Custom exception'],
          [BigInt(0x1A), 'Custom exception'],
          [BigInt(0x1B), 'Custom exception'],
          [BigInt(0x1C), 'Custom exception'],
          [BigInt(0x1D), 'Custom exception'],
          [BigInt(0x1E), 'Custom exception'],
          [BigInt(0x1F), 'Custom exception'],
          [BigInt(0x30), 'Custom exception'],
          [BigInt(0x31), 'Custom exception'],
          [BigInt(0x32), 'Custom exception'],
          [BigInt(0x33), 'Custom exception'],
          [BigInt(0x34), 'Custom exception'],
          [BigInt(0x35), 'Custom exception'],
          [BigInt(0x36), 'Custom exception'],
          [BigInt(0x37), 'Custom exception'],
          [BigInt(0x38), 'Custom exception'],
          [BigInt(0x39), 'Custom exception'],
          [BigInt(0x3A), 'Custom exception'],
          [BigInt(0x3B), 'Custom exception'],
          [BigInt(0x3C), 'Custom exception'],
          [BigInt(0x3D), 'Custom exception'],
          [BigInt(0x3E), 'Custom exception'],
          [BigInt(0x3F), 'Custom exception'],
          [BigInt('0x8000000000000001'), 'Supervisor software interrupt'],
          [BigInt('0x8000000000000002'), 'Virtual supervisor software interrupt'],
          [BigInt('0x8000000000000003'), 'Machine software interrupt'],
          [BigInt('0x8000000000000005'), 'Supervisor timer interrupt'],
          [BigInt('0x8000000000000006'), 'Virtual supervisor timer interrupt'],
          [BigInt('0x8000000000000007'), 'Machine timer interrupt'],
          [BigInt('0x8000000000000009'), 'Supervisor external interrupt'],
          [BigInt('0x800000000000000A'), 'Virtual supervisor external interrupt'],
          [BigInt('0x800000000000000B'), 'Machine external interrupt'],
          [BigInt('0x800000000000000C'), 'Supervisor guest external interrupt'],
          [BigInt('0x800000000000000D'), 'Reserved for counter-overflow interrupt'],
        ])
      },
    ],
  },
  // 0x343 - mtval
  {
    name: 'mtval',
    fields: [
      { width: 64, name: 'VALUE' },
    ],
  },
  // 0x344 - mip
  {
    name: 'mip',
    fields: [
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SSIP' },
      { width: 1, name: 'VSSIP' },
      { width: 1, name: 'MSIP' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'STIP' },
      { width: 1, name: 'VSTIP' },
      { width: 1, name: 'MTIP' },
      { width: 1, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: 'SEIP' },
      { width: 1, name: 'VSEIP' },
      { width: 1, name: 'MEIP' },
      { width: 1, name: 'SGEIP' },
      { width: 1, name: 'LCOFIP' },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 48, type: DecodeFieldType.CSR_WPRI },
    ],
  },
  // 0x3A0 - pmpcfg0
  {
    name: 'pmpcfg0',
    fields: [
      { width: 1, name: '0.R' },
      { width: 1, name: '0.W' },
      { width: 1, name: '0.X' },
      { width: 2, name: '0.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '0.L' },
      { width: 1, name: '1.R' },
      { width: 1, name: '1.W' },
      { width: 1, name: '1.X' },
      { width: 2, name: '1.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '1.L' },
      { width: 1, name: '2.R' },
      { width: 1, name: '2.W' },
      { width: 1, name: '2.X' },
      { width: 2, name: '2.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '2.L' },
      { width: 1, name: '3.R' },
      { width: 1, name: '3.W' },
      { width: 1, name: '3.X' },
      { width: 2, name: '3.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '3.L' },
      { width: 1, name: '4.R' },
      { width: 1, name: '4.W' },
      { width: 1, name: '4.X' },
      { width: 2, name: '4.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '4.L' },
      { width: 1, name: '5.R' },
      { width: 1, name: '5.W' },
      { width: 1, name: '5.X' },
      { width: 2, name: '5.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '5.L' },
      { width: 1, name: '6.R' },
      { width: 1, name: '6.W' },
      { width: 1, name: '6.X' },
      { width: 2, name: '6.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '6.L' },
      { width: 1, name: '7.R' },
      { width: 1, name: '7.W' },
      { width: 1, name: '7.X' },
      { width: 2, name: '7.A', value: ['OFF', 'TOR', 'NA4', 'NAPOT'] },
      { width: 2, type: DecodeFieldType.CSR_RO0 },
      { width: 1, name: '7.L' },
    ],
  },
  // 0x3B0 - pmpaddr0
  {
    name: 'pmpaddr0',
    fields: [
      { width: 54, name: 'ADDRESS' },
      { width: 10, type: DecodeFieldType.CSR_RO0 },
    ],
  },
  // 0x747 - mseccfg
  {
    name: 'mseccfg',
    fields: [
      { width: 1, name: 'MML' },
      { width: 1, name: 'MMWP' },
      { width: 1, name: 'RLB' },
      { width: 5, type: DecodeFieldType.CSR_WPRI },
      { width: 1, name: 'USEED' },
      { width: 1, name: 'SSEED' },
      { width: 1, name: 'MLPE' },
      { width: 21, type: DecodeFieldType.CSR_WPRI },
      { width: 2, name: 'PMM' },
      { width: 30, type: DecodeFieldType.CSR_WPRI },
    ],
  },
]
